"use strict";(self.webpackChunkrent360=self.webpackChunkrent360||[]).push([[196],{6196:(O,l,n)=>{n.r(l),n.d(l,{PropertiesModule:()=>_});var h=n(3128),g=n(4466),o=n(4006),t=n(8256),f=n(1135),c=n(9646),d=n(4004),Z=n(8505),p=n(2340),y=n(3632),v=n(1598),A=n(1312);let T=(()=>{class i{constructor(e,r){this.apiClient=e,this.refresh=r,this.mockStoreKey=y.l,this.state$=new f.X([]),this.initialized=!1}getProperties(){if(this.initialized)return this.state$.asObservable();if(p.N.api.useMockApi){const e=this.readMockStore();if(e)return this.initialized=!0,this.state$.next(e),this.state$.asObservable()}return this.apiClient.get({endpoint:"properties/units",mockPath:"properties/units.json"}).pipe((0,d.U)(e=>e.properties??[]),(0,Z.b)(e=>{this.initialized=!0,this.state$.next(e),this.writeMockStore(e),this.refresh.notifyPropertiesChanged()}),(0,d.U)(()=>this.state$.value))}createProperty(e){if(!p.N.api.useMockApi)return this.apiClient.post("properties",e);const r={id:this.makeId("prop"),name:e.name.trim(),city:e.city.trim(),ownerName:e.ownerName.trim(),status:e.status,units:[]},s=[r,...this.state$.value];return this.state$.next(s),this.writeMockStore(s),this.refresh.notifyPropertiesChanged(),(0,c.of)(r)}updateProperty(e){if(!p.N.api.useMockApi)return this.apiClient.put(`properties/${e.id}`,e);let r;const s=this.state$.value.map(u=>u.id!==e.id?u:(r={...u,name:e.name.trim(),city:e.city.trim(),ownerName:e.ownerName.trim(),status:e.status},r));if(void 0===r)throw new Error("Property not found for update.");return this.state$.next(s),this.writeMockStore(s),this.refresh.notifyPropertiesChanged(),(0,c.of)(r)}makeId(e){return`${e}-${Date.now()}`}readMockStore(){try{const e=localStorage.getItem(this.mockStoreKey);if(!e)return null;const r=JSON.parse(e);return Array.isArray(r)?r:null}catch{return null}}writeMockStore(e){if(p.N.api.useMockApi)try{localStorage.setItem(this.mockStoreKey,JSON.stringify(e))}catch{}}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(v.O),t.LFG(A.y))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var m=n(6895),U=n(9219),x=n(2802),b=n(5213),P=n(7338);let C=(()=>{class i{constructor(e){this.settings=e,this.currency="USD",this.settings.userSettings$.subscribe(r=>{this.currency=r.currency})}transform(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:this.currency,maximumFractionDigits:2}).format(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(P.s,16))},i.\u0275pipe=t.Yjl({name:"appCurrency",type:i,pure:!1}),i})();function S(i,a){if(1&i&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function q(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"section",5)(1,"r360-card")(2,"div",26),t._uU(3),t.qZA(),t.TgZ(4,"form",27),t.NdJ("ngSubmit",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.submit())}),t.TgZ(5,"label",8),t._uU(6," Property Name "),t._UZ(7,"input",28),t.qZA(),t.TgZ(8,"label",8),t._uU(9," City "),t._UZ(10,"input",29),t.qZA(),t.TgZ(11,"label",8),t._uU(12," Owner "),t._UZ(13,"input",30),t.qZA(),t.TgZ(14,"label",8),t._uU(15," Status "),t.TgZ(16,"select",31)(17,"option",13),t._uU(18,"Active"),t.qZA(),t.TgZ(19,"option",14),t._uU(20,"Inactive"),t.qZA()()(),t.TgZ(21,"div",32)(22,"button",33),t._uU(23),t.qZA(),t.TgZ(24,"button",34),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.cancelForm())}),t._uU(25,"Cancel"),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Oqu(e.editMode?"Update Property":"Create Property"),t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(18),t.Q6J("disabled",e.formSubmitting),t.xp6(1),t.Oqu(e.editMode?"Update":"Create")}}function N(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",35)(1,"td",36),t._uU(2),t.qZA(),t.TgZ(3,"td",37),t._uU(4),t.qZA(),t.TgZ(5,"td",37),t._uU(6),t.qZA(),t.TgZ(7,"td",37),t._uU(8),t.qZA(),t.TgZ(9,"td",37),t._uU(10),t.qZA(),t.TgZ(11,"td",37),t._uU(12),t.ALo(13,"appCurrency"),t.qZA(),t.TgZ(14,"td",37),t._UZ(15,"r360-status-badge",25),t.qZA(),t.TgZ(16,"td",37),t._uU(17),t.qZA(),t.TgZ(18,"td",37),t._UZ(19,"r360-status-badge",25),t.qZA(),t.TgZ(20,"td",37)(21,"button",38),t.NdJ("click",function(){const u=t.CHM(e).$implicit,F=t.oxw();return t.KtG(F.editFromRow(u.propertyId))}),t._uU(22,"Edit"),t.qZA()()()}if(2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.propertyName),t.xp6(2),t.Oqu(e.city),t.xp6(2),t.Oqu(e.ownerName),t.xp6(2),t.Oqu((null==e.unit?null:e.unit.unitCode)||"-"),t.xp6(2),t.Oqu((null==e.unit?null:e.unit.type)||"-"),t.xp6(2),t.Oqu(e.unit?t.lcZ(13,9,e.unit.rent):"-"),t.xp6(3),t.Q6J("value",(null==e.unit?null:e.unit.occupancyStatus)||"-"),t.xp6(2),t.Oqu((null==e.unit?null:e.unit.tenantName)||"-"),t.xp6(2),t.Q6J("value",e.propertyStatus)}}const w=[{path:"",component:(()=>{class i{constructor(e,r){this.fb=e,this.propertiesData=r,this.properties=[],this.filteredRows=[],this.search="",this.selectedProperty="All",this.selectedStatus="All",this.showForm=!1,this.editMode=!1,this.editingId="",this.formSubmitting=!1,this.form=this.fb.group({name:["",[o.kI.required,o.kI.minLength(2)]],city:["",[o.kI.required,o.kI.minLength(2)]],ownerName:["",[o.kI.required,o.kI.minLength(2)]],status:["active",o.kI.required]})}ngOnInit(){this.propertiesData.getProperties().subscribe(e=>{this.properties=e,this.applyFilters()})}get propertyOptions(){return["All",...this.properties.map(e=>e.name)]}get totalProperties(){return this.properties.length}get totalUnits(){return this.properties.reduce((e,r)=>e+r.units.length,0)}get occupiedUnits(){return this.properties.flatMap(e=>e.units).filter(e=>"occupied"===e.occupancyStatus).length}get vacantUnits(){return this.properties.flatMap(e=>e.units).filter(e=>"vacant"===e.occupancyStatus).length}onSearch(e){this.search=e,this.applyFilters()}onPropertyFilter(e){this.selectedProperty=e,this.applyFilters()}onStatusFilter(e){this.selectedStatus=e,this.applyFilters()}openCreate(){this.editMode=!1,this.editingId="",this.form.reset({name:"",city:"",ownerName:"",status:"active"}),this.showForm=!0}openEdit(e){this.editMode=!0,this.editingId=e.id,this.form.reset({name:e.name,city:e.city,ownerName:e.ownerName,status:e.status}),this.showForm=!0}editFromRow(e){const r=this.properties.find(s=>s.id===e);r&&this.openEdit(r)}cancelForm(){this.showForm=!1,this.formSubmitting=!1}submit(){if(this.form.invalid||this.formSubmitting)return void this.form.markAllAsTouched();const e=this.form.getRawValue();this.formSubmitting=!0,(this.editMode?this.propertiesData.updateProperty({...e,id:this.editingId}):this.propertiesData.createProperty(e)).subscribe({next:()=>{this.formSubmitting=!1,this.showForm=!1,this.applyFilters()},error:()=>{this.formSubmitting=!1}})}applyFilters(){const e=this.search.trim().toLowerCase();this.filteredRows=this.properties.filter(r=>"All"===this.selectedProperty||r.name===this.selectedProperty).filter(r=>"All"===this.selectedStatus||r.status===this.selectedStatus).flatMap(r=>r.units.length?r.units.map(s=>({propertyId:r.id,propertyName:r.name,propertyStatus:r.status,city:r.city,ownerName:r.ownerName,unit:s})):[{propertyId:r.id,propertyName:r.name,propertyStatus:r.status,city:r.city,ownerName:r.ownerName,unit:void 0}]).filter(r=>!e||[r.propertyName,r.city,r.ownerName,r.unit?.unitCode??"",r.unit?.type??"",r.unit?.tenantName??""].join(" ").toLowerCase().includes(e))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(o.qu),t.Y36(T))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-properties"]],decls:79,vars:11,consts:[[1,"r360-page"],["title","Properties & Units","subtitle","Configurable module backed by mock JSON or real backend"],[1,"r360-section","grid","grid-cols-1","gap-4","sm:grid-cols-2","xl:grid-cols-4"],[1,"text-xs","uppercase","tracking-wide","text-gray-500"],[1,"mt-2","text-3xl","font-bold","text-gray-900","dark:text-gray-100"],[1,"r360-section"],[1,"flex","flex-col","gap-3","lg:flex-row","lg:items-end","lg:justify-between"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-3","lg:min-w-[620px]","lg:flex-1"],[1,"text-xs","font-medium","text-gray-500","dark:text-gray-300"],["type","text","placeholder","Property, city, unit, tenant",1,"r360-input","mt-1",3,"value","input"],[1,"r360-input","mt-1",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],["value","All"],["value","active"],["value","inactive"],["type","button",1,"r360-btn-primary",3,"click"],["class","r360-section",4,"ngIf"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-xl","font-semibold"],[1,"text-xs","text-gray-500"],[1,"r360-table-wrap"],[1,"r360-table"],[1,"border-b","border-gray-200","dark:border-gray-700"],[1,"r360-th"],["class","r360-row",4,"ngFor","ngForOf"],[3,"value"],[1,"mb-4","text-lg","font-semibold"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-2",3,"formGroup","ngSubmit"],["type","text","formControlName","name","placeholder","e.g. Palm Residency",1,"r360-input","mt-1"],["type","text","formControlName","city","placeholder","e.g. Austin",1,"r360-input","mt-1"],["type","text","formControlName","ownerName","placeholder","Owner full name",1,"r360-input","mt-1"],["formControlName","status",1,"r360-input","mt-1"],[1,"sm:col-span-2","flex","flex-wrap","gap-2","pt-2"],["type","submit",1,"r360-btn-primary",3,"disabled"],["type","button",1,"r360-btn-secondary",3,"click"],[1,"r360-row"],[1,"r360-td","font-semibold","text-gray-900","dark:text-gray-100"],[1,"r360-td"],["type","button",1,"r360-btn-secondary","!py-1.5",3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"r360-page-header",1),t.TgZ(2,"section",2)(3,"r360-card")(4,"div",3),t._uU(5,"Total Properties"),t.qZA(),t.TgZ(6,"div",4),t._uU(7),t.qZA()(),t.TgZ(8,"r360-card")(9,"div",3),t._uU(10,"Total Units"),t.qZA(),t.TgZ(11,"div",4),t._uU(12),t.qZA()(),t.TgZ(13,"r360-card")(14,"div",3),t._uU(15,"Occupied Units"),t.qZA(),t.TgZ(16,"div",4),t._uU(17),t.qZA()(),t.TgZ(18,"r360-card")(19,"div",3),t._uU(20,"Vacant Units"),t.qZA(),t.TgZ(21,"div",4),t._uU(22),t.qZA()()(),t.TgZ(23,"section",5)(24,"r360-card")(25,"div",6)(26,"div",7)(27,"label",8),t._uU(28," Search "),t.TgZ(29,"input",9),t.NdJ("input",function(u){return r.onSearch(u.target.value)}),t.qZA()(),t.TgZ(30,"label",8),t._uU(31," Property "),t.TgZ(32,"select",10),t.NdJ("change",function(u){return r.onPropertyFilter(u.target.value)}),t.YNc(33,S,2,2,"option",11),t.qZA()(),t.TgZ(34,"label",8),t._uU(35," Status "),t.TgZ(36,"select",10),t.NdJ("change",function(u){return r.onStatusFilter(u.target.value)}),t.TgZ(37,"option",12),t._uU(38,"All"),t.qZA(),t.TgZ(39,"option",13),t._uU(40,"Active"),t.qZA(),t.TgZ(41,"option",14),t._uU(42,"Inactive"),t.qZA()()()(),t.TgZ(43,"button",15),t.NdJ("click",function(){return r.openCreate()}),t._uU(44,"Add Property"),t.qZA()()()(),t.YNc(45,q,26,4,"section",16),t.TgZ(46,"section",5)(47,"r360-card")(48,"div",17)(49,"h3",18),t._uU(50,"Properties & Units"),t.qZA(),t.TgZ(51,"span",19),t._uU(52),t.qZA()(),t.TgZ(53,"div",20)(54,"table",21)(55,"thead")(56,"tr",22)(57,"th",23),t._uU(58,"Property"),t.qZA(),t.TgZ(59,"th",23),t._uU(60,"City"),t.qZA(),t.TgZ(61,"th",23),t._uU(62,"Owner"),t.qZA(),t.TgZ(63,"th",23),t._uU(64,"Unit"),t.qZA(),t.TgZ(65,"th",23),t._uU(66,"Type"),t.qZA(),t.TgZ(67,"th",23),t._uU(68,"Rent"),t.qZA(),t.TgZ(69,"th",23),t._uU(70,"Occupancy"),t.qZA(),t.TgZ(71,"th",23),t._uU(72,"Tenant"),t.qZA(),t.TgZ(73,"th",23),t._uU(74,"Property Status"),t.qZA(),t.TgZ(75,"th",23),t._uU(76,"Actions"),t.qZA()()(),t.TgZ(77,"tbody"),t.YNc(78,N,23,11,"tr",24),t.qZA()()()()()()),2&e&&(t.xp6(7),t.Oqu(r.totalProperties),t.xp6(5),t.Oqu(r.totalUnits),t.xp6(5),t.Oqu(r.occupiedUnits),t.xp6(5),t.Oqu(r.vacantUnits),t.xp6(7),t.Q6J("value",r.search),t.xp6(3),t.Q6J("value",r.selectedProperty),t.xp6(1),t.Q6J("ngForOf",r.propertyOptions),t.xp6(3),t.Q6J("value",r.selectedStatus),t.xp6(9),t.Q6J("ngIf",r.showForm),t.xp6(7),t.hij("",r.filteredRows.length," rows"),t.xp6(26),t.Q6J("ngForOf",r.filteredRows))},dependencies:[m.sg,m.O5,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.sg,o.u,U.A,x.q,b.e,C]}),i})()}];let _=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.m,h.Bz.forChild(w)]}),i})()}}]);